
// ROULETTE FIELDS
const rouletteItems = [
    {number: 0, color: "green"},
    {number: 32, color: "red"},
    {number: 15, color: "black"},
    {number: 19, color: "red"},
    {number: 4, color: "black"},
    {number: 21, color: "red"},
    {number: 2, color: "black"},
    {number: 25, color: "red"},
    {number: 17, color: "black"},
    {number: 34, color: "red"},
    {number: 6, color: "black"},
    {number: 27, color: "red"},
    {number: 13, color: "black"},
    {number: 36, color: "red"},
    {number: 11, color: "black"},
    {number: 30, color: "red"},
    {number: 8, color: "black"},
    {number: 23, color: "red"},
    {number: 10, color: "black"},
    {number: 5, color: "red"},
    {number: 24, color: "black"},
    {number: 16, color: "red"},
    {number: 33, color: "black"},
    {number: 1, color: "red"},
    {number: 20, color: "black"},
    {number: 14, color: "red"},
    {number: 31, color: "black"},
    {number: 9, color: "red"},
    {number: 22, color: "black"},
    {number: 18, color: "red"},
    {number: 29, color: "black"},
    {number: 7, color: "red"},
    {number: 28, color: "black"},
    {number: 12, color: "red"},
    {number: 35, color: "black"},
    {number: 3, color: "red"},
    {number: 26, color: "black"}
];

// Spin logic
const spinButton = document.getElementById("spinButton");
const roulette = document.getElementById("roulette");
let currentRotation = 0;
let isSpinning = false;

// Gets angle for given number
const getAngle = (number) => {
    let index = rouletteItems.findIndex(item => item.number === number);
    return 360 - (index * 360/37);
}

// Disables button
const disableButton = () => {
    isSpinning = true;
    spinButton.disabled = true;
    spinButton.classList.remove("spin-button-enabled");
    spinButton.classList.add("spin-button-disabled");
    spinButton.innerHTML = "Spinning...";
}
// Enables button
const enableButton = () => {
    isSpinning = false;
    spinButton.disabled = false;
    spinButton.classList.remove("spin-button-disabled");
    spinButton.classList.add("spin-button-enabled");
    spinButton.innerHTML = "Spin";
}   

// Start game button logic
spinButton.addEventListener("click", () => {

    if(isSpinning) return;
    disableButton();

    // backend call for number
    setTimeout(()=>{
        // backend call for number (rn is random)
        let number = Math.floor(Math.random() * 37);
        console.log(`Winning number generated by backend: ${number}`);
        
        // 3-10 rotations
        let additionalRotations = Math.floor(Math.random() * 8) + 3;
        let angle = getAngle(number);

        // Adjusting final angle
        let finalAngle = Math.ceil(currentRotation/360) * 360 + angle + 360 * additionalRotations
        currentRotation = finalAngle;

        // Applying style
        roulette.style.transform = `rotate(${finalAngle}deg)`;

    }, 100)

    // Enables after 5s (time for spinning)
    setTimeout(enableButton, 5000)

});